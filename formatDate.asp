<script language="javascript" runat="server">
function formatDate(format){var format=new String(format),thisDate,formatLen=format.length,ret='',dayNames=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],monthNames=['January','February','March','April','May','June','July','August','September','October','November','December'],tNum,tDays=[7,1,2,3,4,5,6],toMonday=[6,0,1,2,3,4,5],getS=function(fn_day){var fnll,fndl;if(fn_day){fn_day=parseInt(fn_day);}else{fn_day=parseInt(new Date().getDate());}fn_day=new String(fn_day);fnll=fn_day.substring(fn_day.length-1,fn_day.length);fndl=fn_day.substring(fn_day.length-2,fn_day.length);if(fndl>=11&&fndl<=13){return"th";}else if(fnll==1){return"st";}else if(fnll==2){return"nd";}else if(fnll==3){return"rd";}return"th";},getW=function(fn_day){var lastEndWeek,lastBegWeek,thisBegWeek,tNum;lastEndWeek=new Date();lastEndWeek.setUTCFullYear(fn_day.getFullYear()-1);lastEndWeek.setUTCMonth(11);lastEndWeek.setUTCDate(28);lastEndWeek.setUTCHours(0);lastEndWeek.setUTCMinutes(0);lastEndWeek.setUTCSeconds(0);lastBegWeek=new Date();lastBegWeek.setUTCFullYear(lastEndWeek.getFullYear());lastBegWeek.setUTCMonth(11);lastBegWeek.setUTCDate(28-toMonday[lastEndWeek.getDay()]);lastBegWeek.setUTCHours(0);lastBegWeek.setUTCMinutes(0);lastBegWeek.setUTCSeconds(0);thisBegWeek=new Date();thisBegWeek.setUTCFullYear(fn_day.getFullYear());thisBegWeek.setUTCMonth(fn_day.getMonth());thisBegWeek.setUTCDate(fn_day.getDate()-toMonday[thisDate.getDay()]);thisBegWeek.setUTCHours(0);thisBegWeek.setUTCMinutes(0);thisBegWeek.setUTCSeconds(0);tNum=Math.round((thisBegWeek.getTime()-lastBegWeek.getTime())/604800000);tNum=(tNum>52)?tNum-52:tNum;tNum=(tNum==0)?52:tNum;tNum='0'+tNum;return tNum.substring(tNum.length-2);},exactLength=function(num,len){var ret;for(var i=0;i<len;i++){ret+='0';}ret+=num;return ret.substring(ret.length-len);},typeOfArg1=(typeof arguments[1]);if(typeOfArg1=='date'||typeOfArg1=='number'){thisDate=new Date(new Date(arguments[1]));}else{thisDate=new Date();}for(var i=0;i<formatLen;i++){switch(format.substring(i,i+1)){case'd':ret+=exactLength(new String(thisDate.getDate()),2);break;case'D':ret+=dayNames[thisDate.getDay()].substring(0,3);break;case'j':ret+=thisDate.getDate();break;case'l':ret+=dayNames[thisDate.getDay()];break;case'N':ret+=tDays[thisDate.getDay()];break;case'S':ret+=getS(thisDate.getDate());break;case'w':ret+=thisDate.getDay();break;case'z':ret+=Math.floor((thisDate.getTime()-new Date(thisDate.getFullYear(),0,1).getTime())/86400000);break;case'W':ret+=getW(thisDate);break;case'F':ret+=monthNames[thisDate.getMonth()];break;case'm':ret+=exactLength((thisDate.getMonth()+1),2);break;case'M':ret+=monthNames[thisDate.getMonth()].substring(0,3);break;case'n':ret+=(thisDate.getMonth()+1);break;case't':ret+=new Date(thisDate.getFullYear(),thisDate.getMonth()+1,0).getDate();break;case'L':tNum=thisDate.getFullYear();ret+=(tNum%400==0||(tNum%100!=0&&tNum%4==0))?1:0;break;case'o':var thisYear=thisDate.getFullYear();var weekIndex=parseInt(getW(thisDate));var thisMonth=thisDate.getMonth();if(thisMonth==11&&weekIndex==1){thisYear++;}else if(thisMonth==0&&weekIndex==52){thisYear--;}ret+=thisYear;break;case'Y':ret+=thisDate.getFullYear();break;case'y':ret+=new String(thisDate.getFullYear()).substring(2);break;case'a':ret+=(thisDate.getHours()>=12)?'pm':'am';break;case'A':ret+=(thisDate.getHours()>=12)?'PM':'AM';break;case'B':ret+=exactLength(Math.floor((((thisDate.getUTCHours()+1)%24)+thisDate.getUTCMinutes()/60+thisDate.getUTCSeconds()/3600)*1000/24),3);break;case'g':tNum=thisDate.getHours();tNum=(tNum>=12)?tNum-12:tNum;ret+=(tNum==0)?12:tNum;break;case'G':ret+=thisDate.getHours();break;case'h':tNum=thisDate.getHours();tNum=((tNum>=12)?tNum-12:tNum);tNum=((tNum==0)?12:tNum);ret+=exactLength(((tNum==0)?12:tNum),2);break;case'H':ret+=exactLength(thisDate.getHours(),2);break;case'i':ret+=exactLength(thisDate.getMinutes(),2);break;case's':ret+=exactLength(thisDate.getSeconds(),2);break;case'O':var sign='+';tNum=-1*(thisDate.getTimezoneOffset()/60);if(tNum<0){sign='-';tNum*=-1;}ret+=sign+exactLength(tNum,2)+'00';break;case'P':var sign='+';tNum=-1*(thisDate.getTimezoneOffset()/60);if(tNum<0){sign='-';tNum*=-1;}ret+=sign+exactLength(tNum,2)+':00';break;case'T':tNum=thisDate.toString();if(tNum.match(/GMT [\-\+0-9]{5}/)){ret+=tNum.match(/\([a-zA-Z ]+\)/)[0].replace(/[^A-Z]+/g,'');}else{ret+=tNum.match(/([A-Z]{3,4}) [0-9]{4}$/)[1];}break;case'Z':ret+=thisDate.getTimezoneOffset()*-1*60;case'c':ret+=formatDate('Y-m-d\TH:i:sP',thisDate.getTime());break;case'r':ret+=formatDate('D, d M Y H:i:s O',thisDate.getTime());break;case'U':ret+=Math.round(thisDate.getTime()/1000);case'\\':i++;default:ret+=format.substring(i,i+1);}}return ret;}
</script>